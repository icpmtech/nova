<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Nova Aggregator - Explore Nova projects visually and quickly">
  <title>Nova Hub</title>

  <!-- SEO Meta Tags -->
  <meta name="keywords" content="Nova Hub, Nova projects, finance tools, search platforms, LLM platforms, analytics">
  <meta name="author" content="pedro martins & cantinhode.net">
  <meta property="og:title" content="Nova Hub & cantinhode.net">
  <meta property="og:description" content="Explore Nova projects visually and quickly">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://nova-hub.netlify.app/">
  <meta property="og:image" content="https://nova-hub.netlify.app/logo.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Nova Hub">
  <meta name="twitter:description" content="Explore Nova projects visually and quickly">
  <meta name="twitter:image" content="https://nova-hub.netlify.app/logo.png">

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-8M25SCL0G0"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-8M25SCL0G0');
  </script>

  <!-- Auth0 SDK -->
  <script src="https://cdn.auth0.com/js/auth0-spa-js/2.0/auth0-spa-js.production.js"></script>

  <!-- Structured Data for SEO -->
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Nova Hub",
      "url": "https://nova-hub.netlify.app/",
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://nova-hub.netlify.app/?search={search_term_string}",
        "query-input": "required name=search_term_string"
      }
    }
  </script>

  <link rel="stylesheet" href="app.css">
  <style>
    .private-section { display: none; }
    .authenticated .private-section { display: block; }
  </style>
</head>

<body>
  <button class="menu-toggle" id="menuToggle" aria-label="Toggle Menu">☰</button>

  <aside id="sidebar" aria-label="Main Navigation">
    <div class="nav-section">
      <img src="/logo.png" class="logo" alt="Nova Logo">
      <a href="#finance-tools" class="nav-icon" aria-label="Finance Tools">💰</a>
      <a href="#search-platforms" class="nav-icon" aria-label="Search Platforms">🔍</a>
      <a href="#llm-platforms" class="nav-icon" aria-label="LLM Platforms">🤖</a>
      <a href="#analytics" class="nav-icon" aria-label="Analytics & More">📊</a>
    </div>
    <div class="nav-section">
      <a href="#" onclick="login()" class="nav-icon" aria-label="Login">🔐</a>
      <a href="#" onclick="logout()" class="nav-icon" aria-label="Logout">⏻</a>
    </div>
  </aside>

  <main id="main-content">
    <header>
      <h1 id="main-title">Nova Hub</h1>
      <p id="subtitle">Explora os projetos Nova de forma visual e rápida</p>

      <div class="language-switcher" role="group" aria-label="Language Selection">
        <button class="language-btn active" data-lang="pt" aria-pressed="true">PT</button>
        <button class="language-btn" data-lang="en" aria-pressed="false">EN</button>
        <button class="language-btn" data-lang="es" aria-pressed="false">ES</button>
        <button class="language-btn" data-lang="fr" aria-pressed="false">FR</button>
      </div>
    </header>

    <div id="content">
      <!-- Loading spinner -->
      <div class="loading-container" id="loading">
        <div class="loading-spinner" aria-label="Loading content"></div>
      </div>

      <!-- Conteúdo privado -->
      <div class="private-section">
        <h2>Área Privada</h2>
        <p>Bem-vindo! Estás autenticado.</p>
      </div>
    </div>
  </main>

  <button class="scroll-top" id="scrollTop" aria-label="Scroll to top">↑</button>
  <div class="overlay" id="overlay"></div>

  <!-- App Script -->
  <script src="app.js"></script>

  <!-- Auth0 Script -->
  <script>
    let auth0 = null;

    async function initAuth0() {
      auth0 = await createAuth0Client({
        domain: "dev-t72hy4qhy68mjz53.us.auth0.com", // Substituir pelo teu domínio
        client_id: "SlfOOEYc6bzI8onYrFR4zFl1QZpBcCXJ",       // Substituir pelo teu Client ID
        cacheLocation: "localstorage"
      });

      const isAuthenticated = await auth0.isAuthenticated();

      if (!isAuthenticated && window.location.search.includes("code=") && window.location.search.includes("state=")) {
        await auth0.handleRedirectCallback();
        window.history.replaceState({}, document.title, "/");
      }

      const loggedIn = await auth0.isAuthenticated();

      if (loggedIn) {
        document.body.classList.add("authenticated");
        const user = await auth0.getUser();
        console.log("Utilizador autenticado:", user);
      } else {
        document.body.classList.remove("authenticated");
      }
    }

    async function login() {
      await auth0.loginWithRedirect({
        redirect_uri: window.location.origin
      });
    }

    async function logout() {
      auth0.logout({
        returnTo: window.location.origin
      });
    }

    document.addEventListener("DOMContentLoaded", async () => {
      await initAuth0();
    });
  </script>
</body>
</html>
